<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æƒ©ç½š</title>

<style>
body {
  font-family: "Helvetica Neue", Arial, "PingFang SC", "Microsoft YaHei";
  background: linear-gradient(180deg, #dff4ff 0%, #bde3ff 100%);
  display: flex;
  justify-content: center;
  padding: 20px;
}

/* å¡ç‰‡ */
.card {
  width: 360px;
  background: #ffffff;
  border-radius: 22px;
  padding: 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  transition: box-shadow 0.2s;
}

/* æŠ½å¥–ä¸­çš„å¡ç‰‡ç¯å…‰ */
.card.spinning {
  animation: cardGlow 0.8s ease-in-out infinite;
}
@keyframes cardGlow {
  0%   { box-shadow: 0 0 10px rgba(74,155,230,0.3); }
  50%  { box-shadow: 0 0 20px rgba(74,155,230,0.7); }
  100% { box-shadow: 0 0 10px rgba(74,155,230,0.3); }
}

/* æ ‡é¢˜ */
.title {
  text-align: center;
  font-size: 22px;
  color: #4a9be6;
  font-weight: 700;
  margin-bottom: 16px;
}

/* ç½‘æ ¼ */
.grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  border: 2px solid #4a9be6;
  border-radius: 14px;
  overflow: hidden;
}

/* æ™®é€šæ ¼å­ */
.cell {
  border: 1px solid #cfe8ff;
  height: 60px;
  display: flex;
  align-items:center;
  justify-content:center;
  background: white;
  font-size: 14px;
  text-align: center;
  transition: all 0.15s ease-out;
}

/* ä¸­é—´ 2Ã—2 å…”å…” */
.center-emoji {
  grid-column: span 2;
  grid-row: span 2;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 70px;
  background: white;
}

/* é«˜äº®æ ¼å­çš„æ—‹è½¬+é—ªå…‰æ•ˆæœ */
.flash {
  background: #fff3b0 !important;
  border-color: #ffd35b;
  animation: flashSpin 0.35s ease-out infinite;
}
@keyframes flashSpin {
  0%   { transform: scale(1) rotate(0deg);   box-shadow: 0 0 0 rgba(255,228,122,0); }
  50%  { transform: scale(1.12) rotate(4deg); box-shadow: 0 0 12px rgba(255,228,122,0.9); }
  100% { transform: scale(1) rotate(0deg);   box-shadow: 0 0 0 rgba(255,228,122,0); }
}

/* æŒ‰é’® */
.button {
  margin-top: 18px;
  width: 100%;
  background: #4a9be6;
  color: white;
  border: none;
  padding: 12px;
  border-radius: 14px;
  font-size: 17px;
  font-weight: 600;
}
.button:disabled {
  opacity: 0.7;
}
</style>
</head>
<body>

<div class="card" id="card">
  <div class="title">è·Ÿå¨„è‰åµæ¶çš„æƒ©ç½š</div>

  <div class="grid">

    <!-- ç¬¬ 1 è¡Œ -->
    <div class="cell">åƒå¥½åƒçš„</div>         <!-- index 0 -->
    <div class="cell">ä¹°é›¶é£Ÿ</div>           <!-- index 1 -->
    <div class="cell">æœ‹å‹åœˆé“æ­‰</div>       <!-- index 2 -->
    <div class="cell">ä»»é€‰ä¸€ä¸ª</div>         <!-- index 3 -->

    <!-- ç¬¬ 2 è¡Œ -->
    <div class="cell">å–å¥¶èŒ¶</div>           <!-- index 4 -->
    <!-- ä¸­é—´ 2Ã—2ï¼Œä¸€ä¸ªå…ƒç´ è·¨ä¸¤è¡Œä¸¤åˆ— -->
    <div class="center-emoji">ğŸ°</div>        <!-- åªè¿™ä¸€ä¸ªï¼Œå  2Ã—2 -->
    <div class="cell">è½¬è´¦52å…ƒ</div>         <!-- index 5 -->

    <!-- ç¬¬ 3 è¡Œ -->
    <div class="cell">é›¶é£Ÿ</div>       <!-- index 6 -->
    <div class="cell">å†æ¥ä¸€æ¬¡</div>         <!-- index 7 -->

    <!-- ç¬¬ 4 è¡Œ -->
    <div class="cell">å”±å¾æœ</div>           <!-- index 8 -->
    <div class="cell">æ‰“å±è‚¡</div>       <!-- index 9 -->
    <div class="cell">å…¨éƒ¨æ¥ä¸€éï¼</div>     <!-- index10 -->
    <div class="cell">ä¹°è¡£æœ</div>         <!-- index11 -->

  </div>

  <button class="button" id="btn" onclick="start()">éšæœºæŠ½ä¸€ä¸ªæƒ©ç½š</button>
</div>

<script>
let spinning = false;

function start() {
  if (spinning) return; // é˜²æ­¢è¿ç‚¹
  spinning = true;

  const card = document.getElementById('card');
  const btn  = document.getElementById('btn');
  const allCells = document.querySelectorAll('.cell');

  // å¤–åœˆé¡ºæ—¶é’ˆçš„é¡ºåºï¼ˆæ³¨æ„æ˜¯ .cell åœ¨ DOM ä¸­çš„ä¸‹æ ‡ï¼‰
  // å¸ƒå±€ç´¢å¼•ï¼š
  // 0:åƒå¥½åƒçš„  1:ä¹°é›¶é£Ÿ  2:æœ‹å‹åœˆé“æ­‰  3:ä»»é€‰ä¸€ä¸ª
  // 4:å–å¥¶èŒ¶    5:è½¬è´¦52å…ƒ
  // 6:å°é›¶é£Ÿç¤¼åŒ… 7:å†æ¥ä¸€æ¬¡
  // 8:å”±å¾æœ    9:æ‰“å±è‚¡52ä¸‹  10:å…¨éƒ¨æ¥ä¸€éï¼  11:ä¹°æ–°è¡£æœ
  //
  // å¤–åœˆé¡ºæ—¶é’ˆï¼šä¸Šâ†’å³â†’ä¸‹â†’å·¦
  const orderIndex = [
    0, 1, 2, 3,   // ä¸Šè¾¹
    5,            // å³ä¸Šå¾€ä¸‹
    11,10,9,8,    // åº•è¾¹ ä»å³åˆ°å·¦
    6,4           // å·¦ä¸‹ â†’ å·¦ä¸Š
  ];

  const cells = orderIndex.map(i => allCells[i]);

  // æ¸…ç†æ—§çŠ¶æ€
  cells.forEach(c => c.classList.remove('flash'));
  btn.disabled = true;
  btn.textContent = 'æŠ½å¥–ä¸­â€¦';
  card.classList.add('spinning');

  const oneRound = cells.length; // 12 æ ¼
  const extra = 4 + Math.floor(Math.random() * 6); // å¤šè½¬å‡ æ ¼
  const totalSteps = oneRound + extra;

  let step = 0;
  let index = 0;

  function spin() {
    cells.forEach(c => c.classList.remove('flash'));
    cells[index].classList.add('flash');

    step++;
    if (step >= totalSteps) {
      // åœä¸‹
      spinning = false;
      btn.disabled = false;
      btn.textContent = 'éšæœºæŠ½ä¸€ä¸ªæƒ©ç½š';
      card.classList.remove('spinning');
      return;
    }

    index = (index + 1) % cells.length;

    // å…ˆå¿«åæ…¢ï¼šprogress è¶Šå¤§ï¼Œé—´éš”è¶Šå¤§
    const progress = step / totalSteps; 
    const minDelay = 60;   // æœ€å¿«
    const maxDelay = 260;  // æœ€æ…¢
    const delay = minDelay + (maxDelay - minDelay) * (progress * progress);

    setTimeout(spin, delay);
  }

  spin();
}
</script>

</body>
</html>
